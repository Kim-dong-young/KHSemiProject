<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
<properties>
	<entry key="selectListCount">
		SELECT COUNT(*) AS COUNT
		  FROM COMMUNITY
	</entry>
	
	<entry key="selectList">
		SELECT *
		FROM
		(
		    SELECT COMMUNITY_NUMBER,
		       COMMUNITY_TITLE,
		       TAB_NAME,
		       COMMUNITY_VIEWCOUNT,
		       COMMUNITY_DATE,
		       MEMBER_NICKNAME,
		       COUNT(COMMUNITY_COMMENT_NUMBER) AS COMMENT_COUNT,  -- 댓글 수 카운트
		       ROW_NUMBER() OVER(ORDER BY COMMUNITY_DATE DESC) AS RNUM
		    FROM COMMUNITY
		    JOIN COMMUNITY_TAB USING(TAB_NUMBER)
		    JOIN MEMBER USING(MEMBER_NUMBER)
		    LEFT JOIN COMMUNITY_COMMENT USING(COMMUNITY_NUMBER)
		    GROUP BY COMMUNITY_TAB.TAB_NAME, COMMUNITY_NUMBER, COMMUNITY_TITLE, TAB_NAME, 
		             COMMUNITY_VIEWCOUNT, COMMUNITY_DATE, MEMBER_NICKNAME
		)
		WHERE RNUM BETWEEN ? AND ?
	</entry>
	<entry key="selectBoard">
		SELECT C.COMMUNITY_NUMBER,
		       C.COMMUNITY_TITLE,
		       C.COMMUNITY_CONTENT,
		       C.COMMUNITY_VIEWCOUNT,
		       C.COMMUNITY_DATE,
		       M.MEMBER_NICKNAME,
               C.MEMBER_NUMBER,
		       CT.TAB_NAME,
		       COUNT(CL.MEMBER_NUMBER) AS LIKE_COUNT
		  FROM COMMUNITY C
		  JOIN MEMBER M ON(C.MEMBER_NUMBER = M.MEMBER_NUMBER)
		  JOIN COMMUNITY_TAB CT ON(CT.TAB_NUMBER = C.TAB_NUMBER)
	 LEFT JOIN COMMUNITY_LIKE CL ON(C.COMMUNITY_NUMBER = CL.COMMUNITY_NUMBER)
		 WHERE C.COMMUNITY_NUMBER = ?
	  GROUP BY C.COMMUNITY_NUMBER,
		       C.COMMUNITY_TITLE,
		       C.COMMUNITY_CONTENT,
		       C.COMMUNITY_VIEWCOUNT,
		       C.COMMUNITY_DATE,
		       M.MEMBER_NICKNAME,
               C.MEMBER_NUMBER,
		       CT.TAB_NAME
	</entry>
	<entry key="countBoardComment">
		SELECT COUNT(*) AS COMMENT_COUNT
		  FROM COMMUNITY_COMMENT
		 WHERE COMMUNITY_NUMBER = ?
	</entry>
	<entry key="selectCommentList">
		SELECT COMMUNITY_COMMENT_NUMBER ,
			   COMMUNITY_PARENT_NUMBER ,
			   COMMUNITY_NUMBER ,
			   MEMBER_NICKNAME ,
			   MEMBER_NUMBER ,
			   COMMUNITY_COMMENT_CONTENT
		FROM
		(
		    SELECT COMMUNITY_COMMENT_NUMBER ,
			   COMMUNITY_PARENT_NUMBER ,
			   COMMUNITY_NUMBER ,
			   MEMBER_NICKNAME ,
			   MEMBER_NUMBER ,
			   COMMUNITY_COMMENT_CONTENT ,
		       ROW_NUMBER() OVER(ORDER BY COMMUNITY_COMMENT_DATE) AS RNUM
		    FROM COMMUNITY_COMMENT
		  JOIN MEMBER USING (MEMBER_NUMBER)
		 WHERE COMMUNITY_NUMBER = ?
		)
		WHERE RNUM BETWEEN ? AND ?
	</entry>
	<entry key="increaseViewCount">
		UPDATE COMMUNITY
		   SET COMMUNITY_VIEWCOUNT = COMMUNITY_VIEWCOUNT + 1
		 WHERE COMMUNITY_NUMBER = ?
	</entry>
	<entry key="selectCategory">
		SELECT TAB_NUMBER,
	    	   TAB_NAME
	      FROM COMMUNITY_TAB
	     WHERE TAB_NUMBER != 1  -- 1은 공지탭
	</entry>
	<entry key="insertBoard">
		INSERT INTO COMMUNITY
		(
		    COMMUNITY_NUMBER,
		    COMMUNITY_TITLE,
		    COMMUNITY_CONTENT,
		    COMMUNITY_VIEWCOUNT,
		    COMMUNITY_DATE,
		    MEMBER_NUMBER,
		    TAB_NUMBER
		)
		VALUES
		(
		    SEQ_COMMUNITY.NEXTVAL,
		    ?,
		    ?,
		    0,
		    SYSDATE,
		    ?,
		    ?
		)
	</entry>
	<entry key="insertComment">
		INSERT INTO COMMUNITY_COMMENT
		(
		    COMMUNITY_COMMENT_NUMBER,
		    COMMUNITY_NUMBER,
		    MEMBER_NUMBER,
		    COMMUNITY_COMMENT_CONTENT,
		    COMMUNITY_COMMENT_DATE
		)
		VALUES
		(
		    SEQ_COMMUNITY_COMMENT.NEXTVAL,
		    ?,
		    ?,
		    ?,
		    SYSDATE
		)
	</entry>
	<entry key="deleteComment">
		DELETE
		  FROM COMMUNITY_COMMENT
		 WHERE COMMUNITY_NUMBER = ?
	</entry>
	<entry key="deleteCommunityLike">
		DELETE
		  FROM COMMUNITY_LIKE
		 WHERE COMMUNITY_NUMBER = ?
	</entry>
	<entry key="deleteBoard">
		DELETE
		  FROM COMMUNITY
		 WHERE COMMUNITY_NUMBER = ?
	</entry>
	<entry key="deleteMemberComment">
		DELETE
		  FROM COMMUNITY_COMMENT
		 WHERE COMMUNITY_COMMENT_NUMBER = ?
	</entry>
	<entry key="selectBoardTabList">
		SELECT *
		FROM
		(
		    SELECT COMMUNITY_NUMBER,
		       COMMUNITY_TITLE,
		       TAB_NAME,
		       COMMUNITY_VIEWCOUNT,
		       COMMUNITY_DATE,
		       MEMBER_NICKNAME,
		       COUNT(COMMUNITY_COMMENT_NUMBER) AS COMMENT_COUNT,  -- 댓글 수 카운트
		       ROW_NUMBER() OVER(ORDER BY COMMUNITY_DATE DESC) AS RNUM
		    FROM COMMUNITY
		    JOIN COMMUNITY_TAB USING(TAB_NUMBER)
		    JOIN MEMBER USING(MEMBER_NUMBER)
		    LEFT JOIN COMMUNITY_COMMENT USING(COMMUNITY_NUMBER)
            WHERE TAB_NUMBER = ?
		    GROUP BY COMMUNITY_TAB.TAB_NAME, COMMUNITY_NUMBER, COMMUNITY_TITLE, TAB_NAME, 
		             COMMUNITY_VIEWCOUNT, COMMUNITY_DATE, MEMBER_NICKNAME
		)
		WHERE RNUM BETWEEN 1 AND 10
	</entry>
	<entry key="selectBoardTabListCount">
		SELECT COUNT(*) AS COUNT
		  FROM COMMUNITY
		 WHERE TAB_NUMBER = ?
	</entry>
</properties>